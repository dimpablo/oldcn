<!DOCTYPE html>
<html lang="ru">
<head>
    <link rel="stylesheet" href="../../tasks.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Урок 6: 及</title>
</head>
<body>
<h2>Соберите фразу: «Ко второму месяцу будет сильный дождь?»</h2>
<p><strong>Иероглифы:</strong></p>
<div id="pool">及 茲 二 月 有 大 雨 其</div>
<p><strong>Соберите здесь:</strong></p>
<div id="drop"></div>
<button id="check">Проверить</button>
<p id="result" class="message"></p>
<script>
    const expected = ['及', '茲', '二', '月', '有', '大', '雨', '其'];
    const pool = document.getElementById('pool');
    const drop = document.getElementById('drop');
    const check = document.getElementById('check');
    const result = document.getElementById('result');

    pool.querySelectorAll('span,div').forEach(el => el.remove());
    expected.sort(() => Math.random() - 0.5).forEach(char => {
        const box = document.createElement('div');
        box.className = 'char-box';
        box.textContent = char;
        box.onclick = () => {
            const clone = box.cloneNode(true);
            clone.onclick = () => { clone.remove(); pool.appendChild(box); };
            drop.appendChild(clone);
        };
        pool.appendChild(box);
    });

    check.onclick = () => {
        const current = Array.from(drop.children).map(c => c.textContent);
        if (JSON.stringify(current) === JSON.stringify(expected)) {
            result.innerHTML = "✅ Правильно! <strong>及茲二月有大雨其</strong> — классическое употребление 及.";
            sendResult(true);
        } else {
            result.textContent = "❌ Попробуйте снова.";
            sendResult(false);
        }
    };

    function sendResult(success) {
        window.parent.postMessage({ type: "TASK_RESULT", success }, "*");
    }

    window.parent.postMessage({ type: "TASK_EXISTS", valid: true }, "*");
</script>
</body>
</html>