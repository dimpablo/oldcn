<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–°–æ–±–µ—Ä–∏ –ø–µ—Ä–µ–≤–æ–¥ –æ—Ä–∞–∫—É–ª—å–Ω–æ–π –Ω–∞–¥–ø–∏—Å–∏</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      line-height: 1.6;
      max-width: 800px;
      margin: 0 auto;
    }
    h2 {
      color: #2c3e50;
      text-align: center;
    }
    .instructions {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 16px;
    }
    .drop-area {
      min-height: 60px;
      border: 2px dashed #3498db;
      border-radius: 8px;
      padding: 10px;
      margin: 20px 0;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      background: #eef7ff;
      font-size: 24px;
      align-items: center;
    }
    .word-pool {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 15px 0;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 8px;
      min-height: 60px;
      background: #f9f9f9;
      align-items: center;
    }
    .word-box {
      background: white;
      border: 1px solid #ccc;
      border-radius: 6px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: grab;
      font-size: 18px;
      padding: 8px 12px;
      user-select: none;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
      transition: all 0.2s;
      white-space: nowrap;
      margin: 2px;
    }
    .word-box:hover {
      transform: translateY(-2px);
      box-shadow: 0 2px 5px rgba(0,0,0,0.15);
    }
    .word-box.dragging {
      opacity: 0.7;
      transform: scale(1.05);
    }
    .controls {
      margin-top: 20px;
      text-align: center;
    }
    button {
      padding: 10px 18px;
      font-size: 16px;
      background: #3498db;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-right: 10px;
    }
    button:hover {
      background: #2980b9;
    }
    .message {
      margin-top: 15px;
      font-weight: bold;
      color: #e74c3c;
      text-align: center;
    }
    .success {
      color: #27ae60;
    }
    .hint {
      font-style: italic;
      color: #7f8c8d;
      margin-top: 5px;
      font-size: 14px;
    }
    .hint-list {
      margin: 5px 0 0;
      padding-left: 20px;
      color: #7f8c8d;
      font-size: 14px;
      list-style-type: "üî∏ ";
    }
    .hint-list li {
      margin: 3px 0;
    }
    .oracle-text {
      font-size: 24px;
      text-align: center;
      margin: 20px 0;
      font-weight: bold;
    }
    .task-container {
      margin-bottom: 30px;
    }
    .task-title {
      font-weight: bold;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <h2>–°–æ–±–µ—Ä–∏ –ø–µ—Ä–µ–≤–æ–¥ –æ—Ä–∞–∫—É–ª—å–Ω–æ–π –Ω–∞–¥–ø–∏—Å–∏</h2>

  <div class="instructions">
    <p><strong>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å–ª–æ–≤–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ</strong>, —á—Ç–æ–±—ã –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –æ—Ä–∞–∫—É–ª—å–Ω—É—é –Ω–∞–¥–ø–∏—Å—å.</p>
    
  </div>

  <div class="task-container">
    <div class="task-title">1. –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞–¥–ø–∏—Å—å:</div>
    <div class="oracle-text">‰∏çÂÖ∂Èõ®</div>
    
    <p>–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ–≤–∞:</p>
    <div id="word-pool1" class="word-pool"></div>

    <p>–°–æ–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥ –∑–¥–µ—Å—å:</p>
    <div id="drop-area1" class="drop-area"></div>
  </div>

  <div class="task-container">
    <div class="task-title">2. –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞–¥–ø–∏—Å—å:</div>
    <div class="oracle-text">Ë≤û‰∏çÈõ®</div>
    
    <p>–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ–≤–∞:</p>
    <div id="word-pool2" class="word-pool"></div>

    <p>–°–æ–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥ –∑–¥–µ—Å—å:</p>
    <div id="drop-area2" class="drop-area"></div>
  </div>

  <div class="controls">
    <button id="check-btn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
    <button id="reset-btn">–°–±—Ä–æ—Å–∏—Ç—å</button>
  </div>

  <p id="result" class="message"></p>

  <script>
    // –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã (–±–µ–∑ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏)
    const expected1 = [
      ['–Ω–µ', '–±—É–¥–µ—Ç', '–¥–æ–∂–¥—è'],
      ['–Ω–µ', '–ø–æ–π–¥—ë—Ç', '–¥–æ–∂–¥—å'],
      ['–¥–æ–∂–¥—è', '–Ω–µ', '–±—É–¥–µ—Ç'],
      ['–¥–æ–∂–¥—å', '–Ω–µ', '–ø–æ–π–¥—ë—Ç'],
      ['–Ω–µ', '–±—É–¥–µ—Ç', '–¥–æ–∂–¥—å'],
      ['–Ω–µ', '–ø–æ–π–¥—ë—Ç', '–¥–æ–∂–¥—è']
    ];
    
    const expected2 = [
      ['—Å–ø—Ä–∞—à–∏–≤–∞–ª–∏', '–Ω–µ', '–±—É–¥–µ—Ç', '–¥–æ–∂–¥—è'],
      ['–≥–∞–¥–∞–ª–∏', '–Ω–µ', '–ø–æ–π–¥—ë—Ç', '–¥–æ–∂–¥—å'],
      ['—Å–ø—Ä–∞—à–∏–≤–∞–ª–∏', '–¥–æ–∂–¥—è', '–Ω–µ', '–±—É–¥–µ—Ç'],
      ['–≥–∞–¥–∞–ª–∏', '–¥–æ–∂–¥—å', '–Ω–µ', '–ø–æ–π–¥—ë—Ç'],
      ['—Å–ø—Ä–∞—à–∏–≤–∞–ª–∏', '–Ω–µ', '–ø–æ–π–¥—ë—Ç', '–¥–æ–∂–¥—å'],
      ['–≥–∞–¥–∞–ª–∏', '–Ω–µ', '–±—É–¥–µ—Ç', '–¥–æ–∂–¥—è']
    ];

    // –û—Å–Ω–æ–≤–Ω—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è + –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±–º–∞–Ω–æ–∫
    const words1 = ['–Ω–µ', '–±—É–¥–µ—Ç', '–ø–æ–π–¥—ë—Ç', '–¥–æ–∂–¥—è', '–¥–æ–∂–¥—å', '–≤–æ–∑–º–æ–∂–Ω–æ', '–º–æ–∂–µ—Ç', '–ª–∏', '–¥–æ–∂–¥–ª–∏–≤–æ'];
    const words2 = ['—Å–ø—Ä–∞—à–∏–≤–∞–ª–∏', '–≥–∞–¥–∞–ª–∏', '–Ω–µ', '–±—É–¥–µ—Ç', '–ø–æ–π–¥—ë—Ç', '–¥–æ–∂–¥—è', '–¥–æ–∂–¥—å', '–∑–∞–¥–∞–≤–∞–ª–∏', '–ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–ª–∏'];

    const wordPool1 = document.getElementById('word-pool1');
    const wordPool2 = document.getElementById('word-pool2');
    const dropArea1 = document.getElementById('drop-area1');
    const dropArea2 = document.getElementById('drop-area2');
    const checkBtn = document.getElementById('check-btn');
    const resetBtn = document.getElementById('reset-btn');
    const resultEl = document.getElementById('result');

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    function init() {
      wordPool1.innerHTML = '';
      wordPool2.innerHTML = '';
      dropArea1.innerHTML = '';
      dropArea2.innerHTML = '';
      
      // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º —Å–ª–æ–≤–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—É–ª–∞
      const shuffled1 = [...words1].sort(() => Math.random() - 0.5);
      const shuffled2 = [...words2].sort(() => Math.random() - 0.5);
      
      // –°–æ–∑–¥–∞—ë–º –±–ª–æ–∫–∏ —Å–ª–æ–≤ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è
      shuffled1.forEach(word => {
        createWordBox(word, wordPool1, dropArea1);
      });
      
      // –°–æ–∑–¥–∞—ë–º –±–ª–æ–∫–∏ —Å–ª–æ–≤ –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è
      shuffled2.forEach(word => {
        createWordBox(word, wordPool2, dropArea2);
      });
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ–º–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
    function createWordBox(word, pool, dropArea) {
      const box = document.createElement('div');
      box.className = 'word-box';
      box.textContent = word;
      box.draggable = true;

      box.addEventListener('dragstart', (e) => {
        e.dataTransfer.setData('text/plain', word);
        box.classList.add('dragging');
      });

      box.addEventListener('dragend', () => {
        box.classList.remove('dragging');
      });

      pool.appendChild(box);
      
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ drop
      dropArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropArea.style.borderColor = '#e67e22';
      });

      dropArea.addEventListener('dragleave', () => {
        dropArea.style.borderColor = '#3498db';
      });

      dropArea.addEventListener('drop', (e) => {
        e.preventDefault();
        dropArea.style.borderColor = '#3498db';

        const word = e.dataTransfer.getData('text/plain');
        const draggedBox = [...pool.children].find(b => b.textContent === word && b.draggable);

        if (draggedBox) {
          const clone = draggedBox.cloneNode(true);
          clone.draggable = false;
          clone.style.cursor = 'default';
          draggedBox.remove();
          dropArea.appendChild(clone);
        }
      });
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    checkBtn.addEventListener('click', () => {
      const current1 = Array.from(dropArea1.children).map(el => el.textContent.trim());
      const current2 = Array.from(dropArea2.children).map(el => el.textContent.trim());
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–≤—ã–π –ø–µ—Ä–µ–≤–æ–¥
      const isCorrect1 = expected1.some(option => arraysEqual(current1, option));
      const isCorrect2 = expected2.some(option => arraysEqual(current2, option));
      
      if (isCorrect1 && isCorrect2) {
        resultEl.innerHTML = `‚úÖ <strong>–í–µ—Ä–Ω–æ!</strong> –í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–≤–µ–ª–∏ –æ–±–µ –Ω–∞–¥–ø–∏—Å–∏.<br>
          <em>‰∏çÂÖ∂Èõ®</em> = ¬´${current1.join(' ')}¬ª<br>
          <em>Ë≤û ‰∏çÈõ®</em> = ¬´${current2.join(' ')}¬ª`;
        resultEl.className = 'message success';
        sendResult(true);
      } else {
        let message = '‚ùå –ï—Å—Ç—å –æ—à–∏–±–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.';
        if (!isCorrect1 && isCorrect2) {
          message = '‚ùå –ü–µ—Ä–≤—ã–π –ø–µ—Ä–µ–≤–æ–¥ –Ω–µ–≤–µ—Ä–µ–Ω. –í—Ç–æ—Ä–æ–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.';
        } else if (isCorrect1 && !isCorrect2) {
          message = '‚ùå –í—Ç–æ—Ä–æ–π –ø–µ—Ä–µ–≤–æ–¥ –Ω–µ–≤–µ—Ä–µ–Ω. –ü–µ—Ä–≤—ã–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.';
        }
        resultEl.textContent = message;
        resultEl.className = 'message';
        sendResult(false, '–û—à–∏–±–∫–∞ –≤ –ø–µ—Ä–µ–≤–æ–¥–µ');
      }
    });

    // –°–±—Ä–æ—Å
    resetBtn.addEventListener('click', init);

    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    function arraysEqual(a, b) {
      if (a.length !== b.length) return false;
      for (let i = 0; i < a.length; i++) {
        if (a[i] !== b[i]) return false;
      }
      return true;
    }

    function sendResult(success, message) {
      window.parent.postMessage({
        type: "TASK_RESULT",
        success: !!success,
        message: message || (success ? "–ü–µ—Ä–µ–≤–æ–¥ —Å–æ–±—Ä–∞–Ω –≤–µ—Ä–Ω–æ" : "–û—à–∏–±–∫–∞ –≤ –ø–æ—Ä—è–¥–∫–µ —Å–ª–æ–≤")
      }, "*");
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    init();
  </script>
</body>
</html>

<!-- –°–∏–≥–Ω–∞–ª: —ç—Ç–æ –Ω–∞—Å—Ç–æ—è—â–µ–µ –∑–∞–¥–∞–Ω–∏–µ -->
<script>
  window.parent.postMessage({
    type: "TASK_EXISTS",
    valid: true
  }, "*");
</script> 