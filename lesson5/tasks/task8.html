<!DOCTYPE html>
<html lang="ru">
<head>
    <link rel="stylesheet" href="../../tasks.css">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Сопоставьте конструкции</title>
</head>
<body>
<h2>Сопоставьте: инверсия и прямой порядок</h2>
<p><strong>Соедините фразу с её грамматическим типом.</strong></p>

<div id="matching-container">
    <div class="pair">
        <span class="source">帝不我降熯</span>
        <select class="target">
            <option value="">— Выберите —</option>
            <option value="инверсия">Инверсия при 不 + 我</option>
            <option value="прямой">Прямой порядок</option>
            <option value="эмфаза">Эмфатическая конструкция</option>
        </select>
    </div>
    <div class="pair">
        <span class="source">帝降我熯</span>
        <select class="target">
            <option value="">— Выберите —</option>
            <option value="инверсия">Инверсия при 不 + 我</option>
            <option value="прямой">Прямой порядок</option>
            <option value="эмфаза">Эмфатическая конструкция</option>
        </select>
    </div>
    <div class="pair">
        <span class="source">帝其受我佑</span>
        <select class="target">
            <option value="">— Выберите —</option>
            <option value="инверсия">Инверсия при 不 + 我</option>
            <option value="прямой">Прямой порядок</option>
            <option value="эмфаза">Эмфатическая конструкция</option>
        </select>
    </div>
    <div class="pair">
        <span class="source">余受馬方佑</span>
        <select class="target">
            <option value="">— Выберите —</option>
            <option value="инверсия">Инверсия при 不 + 我</option>
            <option value="прямой">Прямой порядок</option>
            <option value="эмфаза">Эмфатическая конструкция</option>
        </select>
    </div>
</div>

<div class="controls">
    <button id="check-btn">Проверить</button>
    <button id="reset-btn">Сбросить</button>
</div>
<p id="result" class="message"></p>

<script>
    const answers = [
        "инверсия",
        "прямой",
        "прямой",
        "прямой"
    ];

    function check() {
        const selects = document.querySelectorAll('.target');
        let correct = 0;
        const results = [];

        selects.forEach((select, i) => {
            const val = select.value;
            if (val === answers[i]) correct++;
            results.push(`${select.previousElementSibling.textContent} → ${val || 'не выбрано'} ${val === answers[i] ? '✅' : '❌'}`);
        });

        const resultEl = document.getElementById("result");
        if (correct === 4) {
            resultEl.innerHTML = '✅ Все верно!<br>' + results.join('<br>');
            sendResult(true);
        } else {
            resultEl.innerHTML = `❌ ${correct}/4 верно.<br>` + results.join('<br>');
            sendResult(false);
        }
    }

    function reset() {
        document.querySelectorAll('.target').forEach(s => s.value = '');
        document.getElementById("result").textContent = '';
    }

    document.getElementById("check-btn").addEventListener("click", check);
    document.getElementById("reset-btn").addEventListener("click", reset);

    function sendResult(success) {
        window.parent.postMessage({
            type: "TASK_RESULT",
            success,
            message: success ? "Все соответствия верны" : "Есть ошибки"
        }, "*");
    }

    window.parent.postMessage({ type: "TASK_EXISTS", valid: true }, "*");
</script>
</body>
</html>